<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Fall in LOVE with Unit Testing!</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/wce.css" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" />

    <style>
      .reveal pre code.monaco {
        min-height: 200px;
        padding: 0;
        padding-top: 3px;
        background-color: white;
      }
      .emphasis {
        color: red;
      }
      .credit {
        display: block;
        font-size: smaller;
      }
      h2.subtitle,
      p.author,
      .credit,
      p.subtitle {
        color: #777;
        font-style: italic;
      }
      .branding .logo {
        position: fixed;
        bottom: 0;
        left: 0;
        max-width: 12vw;
        max-height: 12vh;
        padding: 1.5rem;
      }
      .reveal blockquote {
        padding: 0;
      }
      .smaller-text {
        font-size: 0.6em;
      }
      .monospace {
        font-family: monospace;
      }
      .side-by-side {
        display: flex;
        flex-direction: row;
      }
      .side-by-side > * {
        flex: 1;
      }
      span.emphasized {
        font-weight: bolder;
        color: rgb(19, 61, 128);
      }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section class="r-stack">
          <h1>
            Falling in <span class="emphasis">LOVE</span> with Unit Testing
          </h1>
          <h2 class="subtitle">Joe Skeen</h2>
          <p class="subtitle">
            Slides live at <a href="https://bit.ly/c42-do-24">bit.ly/c42-do-24</a>
          </p>
          <img class="r-stretch" src="./assets/bit.ly_c42-do-24.png" />
        </section>
        <section>
          <section>
            <h2>What is a unit test?</h2>
          </section>
          <section>
            <p>A unit test is a type of <span class="emphasized">automated</span> test which <span class="emphasized">validates logic</span> at the <span class="emphasized">lowest level</span> possible.</p>
          </section>
          <section>
            <div>
              <img
                src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lqWygfNJqWQ4VCyjecQ6Eg.png"
                alt="Testing Pyramid"
              />
            </div>
            <span class="credit">
              Credit: Moke Cohn, Martin Fowler, and Lawrence Tan
            </span>
          </section>
          <section>
            <h2>My definition</h2>
            <p>Unit testing is the process of aligning <span class="emphasized">requirements</span> with <span class="emphasized">reality</span>.</p>
          </section>
        </section>
        <section>
          <section>
            <h2>Thought Exercise</h2>
          </section>
          <section>
            <img class="r-stretch" src="assets/craiyon_door.png" alt="a door" />
            <span class="credit">image by craiyon.com</span>
          </section>
          <section>
            <img
              class="r-stretch"
              src="assets/knob.png"
              alt="a privacy doorknob"
            />
          </section>
          <section>
            <blockquote>
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob, should also turn the outside knob.
            </blockquote>
            <blockquote class="fragment">
              <b>GIVEN</b> the push button is not pressed <br />
              <b>WHEN</b> the user turns the inside knob <br />
              <b>THEN</b> the outside knob should also turn
            </blockquote>
          </section>
          <section>
            <blockquote>
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob,
              <b>should also turn the outside knob.</b>
            </blockquote>
            <blockquote>
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob, <b>should retract the latch bolt.</b>
            </blockquote>
          </section>
          <section>
            <blockquote>
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob <b>clockwise</b>, should also turn the
              outside knob <b>counterclockwise</b>.
            </blockquote>
            <blockquote>
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob <b>counterclockwise</b>, should also
              turn the outside knob <b>clockwise</b>.
            </blockquote>
          </section>
          <section>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob clockwise, should also turn the inside
              knob counterclockwise.
            </blockquote>
            <blockquote class="fragment r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob counterclockwise, should also turn the
              inside knob clockwise.
            </blockquote>
            <blockquote class="fragment r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob, should retract the latch bolt.
            </blockquote>
          </section>
          <section>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob clockwise, should also turn the outside
              knob counterclockwise.
            </blockquote>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob counterclockwise, should also turn the
              outside knob clockwise.
            </blockquote>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the inside knob, should retract the latch bolt.
            </blockquote>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob clockwise, should also turn the inside
              knob counterclockwise.
            </blockquote>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob counterclockwise, should also turn the
              inside knob clockwise.
            </blockquote>
            <blockquote class="r-fit-text">
              A privacy doorknob, when the push button is not pressed, when the
              user turns the outside knob, should retract the latch bolt.
            </blockquote>
          </section>
        </section>
        <section>
          <section>
            <h2>Care about test code quality</h2>
            <p class="subtitle">i.e. DRY</p>
          </section>
          <section>
            <ul class="r-fit-text">
              <li>
                A privacy doorknob,
                <ul>
                  <li>
                    when the push button is not pressed,
                    <ul>
                      <li>
                        when the user turns the inside knob clockwise,
                        <ul>
                          <li>
                            should also turn the outside knob counterclockwise.
                          </li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user turns the inside knob counterclockwise,
                        <ul>
                          <li>should also turn the outside knob clockwise.</li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user turns the outside knob clockwise,
                        <ul>
                          <li>
                            should also turn the inside knob counterclockwise.
                          </li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user turns the outside knob counterclockwise,
                        <ul>
                          <li>should also turn the inside knob clockwise.</li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
          <section>
            <ul class="smaller-text">
              <li>
                A privacy doorknob,
                <ul>
                  <li>
                    when the push button is pressed,
                    <ul>
                      <li>
                        when the user tries to turn the outside knob clockwise,
                        <ul>
                          <li>should not turn the outside knob at all.</li>
                          <li>should not turn the inside knob at all.</li>
                          <li>should not retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user tries to turn the outside knob
                        counterclockwise,
                        <ul>
                          <li>should not turn the outside knob at all.</li>
                          <li>should not turn the inside knob at all.</li>
                          <li>should not retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user tries to turn the inside knob clockwise,
                        <ul>
                          <li>should pop the push button out.</li>
                          <li>should turn the inside knob clockwise.</li>
                          <li>
                            should turn the outside knob counterclockwise.
                          </li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user tries to turn the inside knob
                        counterclockwise,
                        <ul>
                          <li>should pop the push button out.</li>
                          <li>should turn the inside knob counterclockwise.</li>
                          <li>should turn the outside knob clockwise.</li>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
          <section>
            <h2>Other use cases</h2>
            <ul>
              <li>
                A privacy doorknob,
                <ul>
                  <li>
                    when the push button is pressed,
                    <ul>
                      <li>
                        when the user tries to close the door (press the latch
                        bolt)
                        <ul>
                          <li>should retract the latch bolt.</li>
                        </ul>
                      </li>
                      <li>
                        when the user inserts a long pin into the hole on the
                        outside knob,
                        <ul>
                          <li>should pop the push button out.</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
          <section>
            <h2>Exceptional use cases</h2>
            <ul>
              <li>
                A privacy doorknob,
                <ul>
                  <li>
                    when the button is pressed,
                    <ul>
                      <li>
                        when the user uses excessive force to try to turn the
                        outside knob,
                        <ul>
                          <li>the knob should not break.</li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h2>Implementing Tests</h2>
            <p class="subtitle">with AAA</p>
          </section>
          <section>
            <ul>
              <li><b>Arrange:</b> Initialize object, set properties</li>
              <li><b>Act:</b> Call the function you are testing</li>
              <li><b>Assert:</b> Verify the results</li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <pre class="r-stretch"><code class="monaco" language="powershell">
enum LatchBoltState {
    Extended
    Retracted
}
enum RotationDirection {
    Clockwise
    CounterClockwise
}
$rotationDirectionOpposite = @{
    TypeName   = 'RotationDirection'
    MemberName = 'Opposite'
    MemberType = 'ScriptMethod'
    Value      = {
        if ($this -eq [RotationDirection]::Clockwise) {
            return [RotationDirection]::CounterClockwise
        }
        else {
            return [RotationDirection]::Clockwise
        }
    }
}
Update-TypeData @rotationDirectionOpposite

class KnobInteractionResult {
    [RotationDirection] $insideKnob
    [RotationDirection] $outsideKnob
    [LatchBoltState] $latchBolt
}

class PrivacyDoorknob {
    hidden [boolean] $isButtonPressed = $false

    [boolean] IsButtonPressed() {
        return $this.isButtonPressed
    }

    [void] PressButton() {
        $this.isButtonPressed = $true
    }

    [KnobInteractionResult] TurnOutsideKnob([RotationDirection] $direction) {
        if ($this.isButtonPressed) {
            return [KnobInteractionResult]::new(
                $null,
                $null,
                [LatchBoltState]::Extended
            )
        }
        return [KnobInteractionResult]::new(
            $direction.Opposite(),
            $direction,
            [LatchBoltState]::Retracted
        )
    }
    
    [KnobInteractionResult] TurnInsideKnob([RotationDirection] $direction) {
        $this.isButtonPressed = $false
        return [KnobInteractionResult]::new(
            $direction,
            $direction.Opposite(),
            [LatchBoltState]::Retracted
        )
    }
}
			</code></pre>
          </section>
          <section>
            <pre class="r-stretch"><code class="monaco" language="powershell">
Describe '' {}
			</code></pre>
          </section>
          <section>
            <pre class="r-stretch"><code class="monaco" language="powershell">
Describe '' {
	# * A privacy doorknob,
	#     * when the push button is pressed,
	#         * when the user tries to turn the outside knob clockwise,
	#             * should not turn the outside knob at all.
	#             * should not turn the inside knob at all.
	#             * should not retract the latch bolt.
	#         * when the user tries to turn the outside knob counterclockwise,
	#             * should not turn the outside knob at all.
	#             * should not turn the inside knob at all.
	#             * should not retract the latch bolt.
	#         * when the user tries to turn the inside knob clockwise,
	#             * should pop the push button out.
	#             * should turn the inside knob clockwise.
	#             * should turn the outside knob counterclockwise.
	#             * should retract the latch bolt.
	#         * when the user tries to turn the inside knob counterclockwise,
	#             * should pop the push button out.
	#             * should turn the inside knob counterclockwise.
	#             * should turn the outside knob clockwise.
	#             * should retract the latch bolt.
}
			</code></pre>
          </section>
          <section>
            <pre class="r-stretch"><code class="monaco" language="powershell">
Describe 'A privacy doorknob' {
	Context 'when the push button is pressed' {
		Context 'when the user tries to turn the outside knob clockwise' {
			It 'should not turn the outside knob at all' {}
			It 'should not turn the inside knob at all' {}
			It 'should not retract the latch bolt' {}
		}
	}
	
	#         * when the user tries to turn the outside knob counterclockwise,
	#             * should not turn the inside knob at all.
	#             * should not retract the latch bolt.
	#         * when the user tries to turn the inside knob clockwise,
	#             * should pop the push button out.
	#             * should turn the inside knob clockwise.
	#             * should turn the outside knob counterclockwise.
	#             * should retract the latch bolt.
	#         * when the user tries to turn the inside knob counterclockwise,
	#             * should pop the push button out.
	#             * should turn the inside knob counterclockwise.
	#             * should turn the outside knob clockwise.
	#             * should retract the latch bolt.
}

			</code></pre>
          </section>
          <section>
				<pre class="r-stretch"><code class="monaco" language="powershell">
It 'should not turn the outside knob at all' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.OutsideKnob | Should -Be $null
}
				</code></pre>
          </section>
          <section>
				<pre class="r-stretch"><code class="monaco" language="powershell">
It 'should not turn the outside knob at all' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.OutsideKnob | Should -Be $null
}
It 'should not turn the inside knob at all' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.InsideKnob | Should -Be $null
}
It 'should not retract the latch bolt' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.LatchBolt | Should -Be ([LatchBoltState]::Extended)
}
				</code></pre>
          </section>
          <section>
        <pre class="r-stretch"><code>PS> Invoke-Pester -Configuration ([PesterConfiguration]@{Output=@{Verbosity="Detailed"}})
Pester v5.5.0

Starting discovery in 1 files.
Discovery found 3 tests in 2ms.
Running tests.

Running tests from 'Knob.Tests.ps1'
Describing A privacy doorknob
 Context when the push button is pressed
  Context when the user tries to turn the outside knob clockwise
    [+] should not turn the outside knob at all 19ms (7ms|12ms)
    [+] should not turn the inside knob at all 6ms (6ms|1ms)
    [+] should not retract the latch bolt 16ms (16ms|1ms)
Tests completed in 68ms
Tests Passed: 3, Failed: 0, Skipped: 0 NotRun: 0</code></pre>
          </section>
          <section>
				<pre class="r-stretch"><code class="monaco" language="powershell">
It 'should not turn the outside knob at all' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.OutsideKnob | Should -Be $null
}
It 'should not turn the inside knob at all' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.InsideKnob | Should -Be $null
}
It 'should not retract the latch bolt' {
    # Arrange
    . "$PSScriptRoot/Knob.ps1"
    $knob = New-Object 'PrivacyDoorKnob'
    $knob.PressButton()

    # Act
    $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)

    # Assert
    $result.LatchBolt | Should -Be ([LatchBoltState]::Extended)
}
				</code></pre>
          </section>
          <section>
			<h2>Time to DRY</h2>
            <pre class="r-stretch"><code class="monaco" language="powershell">
Describe 'A privacy doorknob' {
    Context 'when the push button is pressed' {
        Context 'when the user tries to turn the outside knob clockwise' {
            It 'should not turn the outside knob at all' {
                # Arrange
                . "$PSScriptRoot/Knob.ps1"
                $knob = New-Object 'PrivacyDoorKnob'
                $knob | Should -Not -Be $null
                $knob.PressButton()
            
                # Act
                $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)
            
                # Assert
                $result.OutsideKnob | Should -Be $null
            }
            It 'should not turn the inside knob at all' {
                # Arrange
                . "$PSScriptRoot/Knob.ps1"
                $knob = New-Object 'PrivacyDoorKnob'
                $knob | Should -Not -Be $null
                $knob.PressButton()
            
                # Act
                $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)
            
                # Assert
                $result.InsideKnob | Should -Be $null
            }
            It 'should not retract the latch bolt' {
                # Arrange
                . "$PSScriptRoot/Knob.ps1"
                $knob = New-Object 'PrivacyDoorKnob'
                $knob | Should -Not -Be $null
                $knob.PressButton()
            
                # Act
                $result = $knob.TurnOutsideKnob([RotationDirection]::Clockwise)
            
                # Assert
                $result.LatchBolt | Should -Be ([LatchBoltState]::Extended)
            }
        }
    }
	
    #         * when the user tries to turn the outside knob counterclockwise,
    #             * should not turn the inside knob at all.
    #             * should not retract the latch bolt.
    #         * when the user tries to turn the inside knob clockwise,
    #             * should pop the push button out.
    #             * should turn the inside knob clockwise.
    #             * should turn the outside knob counterclockwise.
    #             * should retract the latch bolt.
    #         * when the user tries to turn the inside knob counterclockwise,
    #             * should pop the push button out.
    #             * should turn the inside knob counterclockwise.
    #             * should turn the outside knob clockwise.
    #             * should retract the latch bolt.
}
			</code></pre>
          </section>
        </section>
        <section>
          <h2>Don't get carried away</h2>
		  <p class="monospace">function Remove-Vowel([string]$input) {&lt;# TODO #&gt;}</p>
		  <p>
			Test:
			<ul>
				<li>the empty String</li>
				<li>a small string with some vowels</li>
				<li>a small string with only vowels</li>
				<li>a small string with no vowels</li>
				<li>a very large String</li>
				<li>a string with complex unicode characters (i.e. emoji)</li>
			</ul>
		  </p>
        </section>
		<section>
			<img
				class="r-stretch"
				src="assets/craiyon_journey.png"
				alt="your coding journey continues"
			/>
		</section>
		<section>
			<h2>Go forth and unit test!</h2>
			<p>
				Contact me:<br />
				<a href="mailto:joe@worldclassengineers.dev">joe@worldclassengineers.dev</a>
			</p>
			<h2>Thanks for watching!</h2>
      <img class="r-stretch" src="./assets/joe-qr.svg" />
		</section>
      </div>
    </div>
    <div class="branding">
      <img class="logo" src="assets/wce-logo.png" alt="World-Class Engineers" />
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <!-- <script src="plugin/highlight/highlight.js"></script> -->
    <script type="module">
      import RevealMonaco from "./plugin/monaco/plugin.js";

      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        monaco: {
          defaultLanguage: "powershell",
        },

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [
          RevealMarkdown,
          RevealNotes,
          RevealMonaco,
          // RevealHighlight,
        ],
      });
    </script>
  </body>
</html>
